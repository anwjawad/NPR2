/* =============================================================================
   Palliative Rounds — Modern Redesign (v3)
   Themes: onyx (dark, default), pearl (clean light), sunset (vibrant gradient)
   - Clear typography and accessible contrast
   - Smooth micro-interactions
   - Patients list rendered as a responsive cards grid (no logic changes)
   - Works with original IDs/classes; zero JS/logic modifications required
   ========================================================================== */

/* ------------------------------
   THEME TOKENS (DEFAULT: ONYX)
   ------------------------------ */
:root,
body:not([data-theme]),
body[data-theme="onyx"]{
  /* Surfaces */
  --bg: #0b0e14;              /* page bg */
  --bg-2: #0e131c;            /* sidebar/topbar */
  --panel: #111827;           /* panels */
  --card: #121c2e;            /* card base */
  --card-2: #0f1726;          /* card gradient end */

  /* Text */
  --text: #f2f5ff;
  --muted: #9aa6bf;

  /* Accents */
  --primary: #6aa9ff;         /* primary button/links */
  --accent: #b585ff;          /* secondary accent */
  --accent-2: #5be2c0;        /* mint accent */

  /* Status */
  --success: #38d39f;
  --warn:    #ffb454;
  --danger:  #ff6b7a;

  /* UI */
  --chip: #111a2a;
  --border: rgba(255,255,255,.10);
  --shadow-1: 0 8px 24px rgba(0,0,0,.28);
  --shadow-2: 0 14px 40px rgba(0,0,0,.38);
  --radius-lg: 18px;
  --radius-md: 14px;
  --radius-sm: 10px;
  --gap: 14px;

  /* Motion */
  --speed-fast: 140ms;
  --speed: 200ms;
  --speed-slow: 280ms;

  /* Scrollbar */
  --scroll-track: rgba(255,255,255,.06);
  --scroll-thumb: rgba(255,255,255,.25);

  /* Typography */
  --fs-12:12px; --fs-13:13px; --fs-14:14px; --fs-15:15px; --fs-16:16px; --fs-18:18px; --fs-20:20px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

  /* Decorative gradient used in headers/cards */
  --decor-grad: radial-gradient(800px 400px at 80% -10%, rgba(90,166,255,.14), transparent 60%);
}

/* ------ PEARL (light) ------ */
body[data-theme="pearl"]{
  --bg: #f5f7fb;
  --bg-2: #ffffff;
  --panel: #ffffff;
  --card: #ffffff;
  --card-2: #f2f5ff;

  --text: #0c1222;
  --muted: #5f6882;

  --primary: #2f66ff;
  --accent: #7d5cff;
  --accent-2: #12bca0;

  --success: #12a17f;
  --warn: #c27b12;
  --danger: #d9485a;

  --chip: #eef2ff;
  --border: rgba(0,0,0,.10);
  --shadow-1: 0 8px 20px rgba(0,0,0,.10);
  --shadow-2: 0 16px 40px rgba(0,0,0,.12);

  --scroll-track: rgba(0,0,0,.06);
  --scroll-thumb: rgba(0,0,0,.20);

  --decor-grad: radial-gradient(800px 400px at 80% -10%, rgba(47,102,255,.10), transparent 60%);
}

/* ------ SUNSET (vibrant gradient) ------ */
body[data-theme="sunset"]{
  --bg: #0a0b10;
  --bg-2: #0e1020;
  --panel: #10162b;
  --card: #111c34;
  --card-2: #0f2138;

  --text: #eef6ff;
  --muted: #9bb3d2;

  --primary: #ff8bb0;   /* rosy */
  --accent:  #67d2ff;   /* cyan */
  --accent-2:#ffda66;   /* soft amber */

  --success: #46d8a2;
  --warn: #ffbe62;
  --danger: #ff6b7a;

  --chip: #101b30;
  --border: rgba(255,255,255,.12);
  --shadow-1: 0 10px 26px rgba(0,0,0,.30);
  --shadow-2: 0 18px 46px rgba(0,0,0,.40);

  --scroll-track: rgba(255,255,255,.07);
  --scroll-thumb: rgba(255,255,255,.28);

  /* sunset sweep on headers/buttons */
  --decor-grad: linear-gradient(135deg, rgba(255,139,176,.22), rgba(103,210,255,.20) 60%, rgba(255,218,102,.18));
}

/* ------------------------------
   BASE
   ------------------------------ */
*{ box-sizing: border-box; }
html, body{ height:100%; }
body{
  margin:0;
  background: var(--decor-grad), var(--bg);
  color: var(--text);
  font: 15px/1.6 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
*, *::before, *::after{
  transition:
    background-color var(--speed) ease,
    border-color var(--speed) ease,
    color var(--speed) ease,
    box-shadow var(--speed) ease,
    transform var(--speed-fast) ease,
    opacity var(--speed) ease;
}
#app{ display:flex; min-height:100vh; }

/* ------------------------------
   SIDEBAR
   ------------------------------ */
#sidebar{
  width:300px; min-width:280px;
  background: linear-gradient(180deg, var(--bg-2), transparent 100%);
  border-right: 1px solid var(--border);
  padding: 18px 16px;
  position: sticky; top: 0; height: 100vh; overflow: auto;
}
.brand{ display:flex; align-items:center; gap:12px; margin-bottom:18px; }
.brand .logo{
  width:44px; height:44px; border-radius: 12px;
  background: conic-gradient(from 0deg, var(--primary), var(--accent), var(--accent-2), var(--primary));
  color:#fff; display:grid; place-items:center; font-weight:800; letter-spacing:.3px;
  box-shadow: var(--shadow-1);
}
.brand .title{ font-weight:800; font-size: var(--fs-18); letter-spacing:.2px; }
.brand .subtitle{ color: var(--muted); font-size: var(--fs-12); }

.section{ margin: 18px 0; }
.section-title{ color: var(--muted); font-size: var(--fs-12); letter-spacing:.5px; margin-bottom: 8px; }
.sections{ display:flex; flex-direction:column; gap:8px; }
.pill{
  background: var(--chip);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 10px 12px;
  border-radius: 12px;
  font-weight: 700;
  cursor: pointer;
  text-align: left;
}
.pill:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
.pill.active{ outline: 2px solid rgba(106,169,255,.35); }

/* ------------------------------
   MAIN / TOPBAR
   ------------------------------ */
#main{ flex:1; display:flex; flex-direction:column; }
#topbar{
  position: sticky; top:0; z-index: 50;
  display:flex; align-items:center; gap:14px;
  padding: 14px 18px;
  border-bottom: 1px solid var(--border);
  background: rgba(16,22,39,.55);
  backdrop-filter: blur(6px) saturate(120%);
}
body[data-theme="pearl"] #topbar{ background: rgba(255,255,255,.75); }
#topbar input[type="search"]{
  flex:1;
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 10px 12px;
  box-shadow: var(--shadow-1);
}
#section-ops{ display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
#active-section-label{ color: var(--muted); font-size: var(--fs-12); }

/* Layout columns */
#columns{ display:grid; grid-template-columns: 1fr; gap: 16px; padding: 16px; }
@media (min-width: 1100px){
  #columns{ grid-template-columns: 380px 1fr; }
}

/* ------------------------------
   CARDS / PANELS
   ------------------------------ */
.card{
  background: linear-gradient(180deg, var(--card), var(--card-2));
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-2);
  padding: 14px;
}
.card .card-head{
  display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:6px;
}
.card-title{ font-weight: 900; font-size: var(--fs-16); letter-spacing:.2px; }

/* ------------------------------
   BUTTONS / CHIPS / MISC
   ------------------------------ */
.btn{
  background: #1a2440;
  color: var(--text);
  border: 1px solid var(--border);
  padding: 10px 14px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 700;
  box-shadow: 0 2px 0 rgba(0,0,0,.18);
}
.btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
.btn:active{ transform: translateY(0); }
.btn-ghost{ background: transparent; }
.btn-primary{
  background: linear-gradient(135deg, var(--primary), var(--accent));
  color:#fff; border: none; box-shadow: var(--shadow-1);
}
.btn-danger{ background: #3a1320; border-color: #5d1b2f; color: #ffd6dd; }
.w100{ width:100%; }

.chip{
  display:inline-flex; align-items:center; gap:6px;
  background: var(--chip);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 6px 10px;
  border-radius: 999px;
  font-size: var(--fs-12);
  font-weight: 800;
}
.chip.high{ background:#371424; border-color:#5c1b34; color:#ff9fb0; }
.chip.low{  background:#0f2842; border-color:#153a60; color:#bfe0ff; }

/* Status badges often used in patients rows */
.status{
  display:inline-flex; align-items:center; gap:6px;
  padding:3px 10px; border-radius:999px; font-size:var(--fs-12);
  border:1px solid var(--border); font-weight:800;
}
.status.open{ background:#1a2552; color:#d6e0ff; }
.status.done{ background:#0f3125; color:#c9ffe9; border-color:#2a6b52; }
.dot{ width:8px; height:8px; border-radius:50%; display:inline-block; }
.dot-green{ background: var(--success); }
.muted{ color: var(--muted); }
.small{ font-size: var(--fs-12); }
.mono{ font-family: var(--mono); }

/* ------------------------------
   TABS
   ------------------------------ */
.tabs{ display:flex; gap:8px; flex-wrap:wrap; }
.tab{
  background:#1b2444; border:1px solid var(--border); color:var(--text);
  border-radius: 999px; padding: 6px 12px; font-size: 13px; font-weight: 800;
  cursor: pointer;
}
.tab:hover{ transform: translateY(-1px); }
.tab.active{ background:#26346d; border-color:#3b4da6; }

/* ------------------------------
   FIELDS
   ------------------------------ */
.field{ display:flex; flex-direction:column; gap:6px; }
.field .label{ color: var(--muted); font-size: var(--fs-12); font-weight: 800; letter-spacing:.2px; }
.field input, .field textarea{
  background:#0f1629; color:var(--text);
  border:1px solid var(--border); border-radius: 12px; padding:10px 12px; width:100%;
  font-size: var(--fs-14);
}
body[data-theme="pearl"] .field input,
body[data-theme="pearl"] .field textarea{ background:#ffffff; }

/* ------------------------------
   PATIENTS — TRUE GRID CARDS
   Targets original IDs produced by app.js:
   - #patients-list (container)
   - .row (each patient item)
   Without changing any logic.
   ------------------------------ */

/* Container becomes a grid */
#patients-list{
  max-height: calc(100vh - 220px);
  overflow: auto;
  padding-right: 4px;

  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
}

/* Each ".row" becomes a card */
#patients-list .row{
  display: grid;
  grid-template-columns: 1fr; /* stack header/lines automatically */
  gap: 8px;

  background: linear-gradient(180deg, var(--card), var(--card-2));
  border: 1px solid var(--border);
  border-radius: 16px;

  padding: 12px;
  box-shadow: var(--shadow-1);
  cursor: default;
}

/* Hover/active effects */
#patients-list .row:hover{
  transform: translateY(-2px);
  border-color: rgba(255,255,255,.18);
  box-shadow: var(--shadow-2);
}

/* Common text roles inside a patient row (class names may originate from app.js) */
#patients-list .row .row-title{
  font-weight: 900; font-size: var(--fs-16); letter-spacing:.2px;
}
#patients-list .row .row-sub{
  color: var(--muted); font-size: var(--fs-12);
}
#patients-list .row .row-code{
  font-family: var(--mono); color: #bcd3ff; font-weight: 700;
}
#patients-list .row .row-tags,
#patients-list .row .tags{ display:flex; flex-wrap:wrap; gap:6px; }

/* Abnormal/symptom chips often injected by logic */
.row-chip{
  display:inline-flex; align-items:center; font-size:var(--fs-12);
  padding: 4px 8px; border-radius: 999px;
  border: 1px solid var(--border); background: var(--chip); font-weight: 800;
}
.row-chip.abn{ background:#341323; border-color:#5e1733; color:#ff9fb0; }
.row-chip.sym{ background:#20314f; border-color:#2a3d6e; color:#b7d2ff; }

/* ------------------------------
   DASHBOARD & GRIDS
   ------------------------------ */
.grid{ display:grid; gap:10px; }
.grid-2{ grid-template-columns: repeat(2, minmax(0,1fr)); }
@media (max-width: 980px){ .grid-2{ grid-template-columns: 1fr; } }

.score-grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px; }
@media (min-width:1200px){ .score-grid{ grid-template-columns: repeat(3, minmax(0,1fr)); } }

.score-item{
  background:#0f1930; border:1px solid var(--border); border-radius: 14px; padding: 10px;
  box-shadow: var(--shadow-1);
}
body[data-theme="pearl"] .score-item{ background:#f6f8ff; }

.labs-grid{ display:grid; gap:10px; grid-template-columns: repeat(2, minmax(0,1fr)); }
@media (min-width:1200px){ .labs-grid{ grid-template-columns: repeat(3, minmax(0,1fr)); } }
.lab{
  background:#0f1930; border:1px solid var(--border); border-radius: 14px; padding: 10px; box-shadow: var(--shadow-1);
}
.lab-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px; }
.lab-name{ font-weight: 900; }
.lab input{
  width:100%; background:#0b1326; border:1px solid #2b3b6a; border-radius: 10px; padding: 8px 10px; color: var(--text);
}
.lab.abnormal-high{ border-color:#6b0b22; box-shadow:0 0 0 1px rgba(255,0,55,.25) inset; }
.lab.abnormal-high .lab-name{ color:#ff9fb0; }
.lab.abnormal-low{ border-color:#0b3f6b; box-shadow:0 0 0 1px rgba(80,180,255,.25) inset; }
.lab.abnormal-low .lab-name{ color:#bfe0ff; }

.chips{ display:flex; flex-wrap:wrap; gap:6px; margin: 8px 0; }

/* ------------------------------
   TABBED CONTENT
   ------------------------------ */
.tabpanes{ margin-top:10px; }
.tabpane{ display:none; }
.tabpane.active{ display:block; }

/* ------------------------------
   TOASTS
   ------------------------------ */
#toast-root{ position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:2000; }
.toast{
  background:#161f3d; border:1px solid var(--border); color:var(--text);
  padding:10px 12px; border-radius: 12px; box-shadow: var(--shadow-2); max-width: 360px; font-weight: 800;
}
.toast.success{ background:#0f2d21; border-color:#275c48; color:#caffee; }
.toast.danger{ background:#3a121b; border-color:#7a1f33; color:#ffd6dd; }
.toast.warn{ background:#3a2e13; border-color:#7e6624; color:#ffefc9; }

/* ------------------------------
   MODALS
   ------------------------------ */
.modal{
  position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
  background: rgba(7,10,18,.55); z-index:1500;
}
.modal.hidden{ display:none; }
.modal-card{
  width: min(760px, 94vw);
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow-2);
  overflow: hidden;
  transform: translateY(10px);
  opacity: 0;
}
.modal-header, .modal-footer{ padding: 12px 14px; background: #0f182e; border-bottom:1px solid var(--border); }
.modal-footer{ border-top:1px solid var(--border); border-bottom: none; display:flex; justify-content:flex-end; gap:8px; }
.modal-body{ padding: 14px; }
.modal-card-full{ width:min(1400px, 96vw); height:94vh; display:flex; flex-direction:column; border-radius:18px; }
.modal-body.modal-body-pad{ padding:18px; overflow:auto; }
.modal:not(.hidden) .modal-card{
  transform: translateY(0); opacity:1; transition: transform var(--speed) ease, opacity var(--speed) ease;
}

/* ------------------------------
   SCROLLBARS
   ------------------------------ */
#patients-list,
#csv-preview,
.modal-body,
body{
  scrollbar-color: var(--scroll-thumb) var(--scroll-track);
}
#patients-list::-webkit-scrollbar,
#csv-preview::-webkit-scrollbar,
.modal-body::-webkit-scrollbar,
body::-webkit-scrollbar{ width:10px; height:10px; }
#patients-list::-webkit-scrollbar-track,
#csv-preview::-webkit-scrollbar-track,
.modal-body::-webkit-scrollbar-track,
body::-webkit-scrollbar-track{ background: var(--scroll-track); border-radius: 999px; }
#patients-list::-webkit-scrollbar-thumb,
#csv-preview::-webkit-scrollbar-thumb,
.modal-body::-webkit-scrollbar-thumb,
body::-webkit-scrollbar-thumb{ background: var(--scroll-thumb); border-radius: 999px; }

/* ------------------------------
   ACCESSIBILITY
   ------------------------------ */
:focus{ outline: 2px solid rgba(106,169,255,.55); outline-offset: 2px; }

/* ------------------------------
   RESPONSIVE
   ------------------------------ */
@media (max-width: 1100px){
  #columns{ grid-template-columns: 1fr; }
  #sidebar{ position: static; height: auto; }
  .modal-card-full{ width:96vw; height:92vh; }
}
